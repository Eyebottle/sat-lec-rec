# Zoom 자동화 테스트 가이드

## 🎯 목적

실제 예약 강의를 놓치지 않도록, **안전하게** Zoom 자동화 기능을 테스트하는 방법입니다.

---

## ✅ 가장 간단한 방법: Personal Meeting Room (PMI) 사용

### 1️⃣ **PMI 링크 확인하기**

#### 방법 A: Zoom 웹사이트
```
1. https://zoom.us/profile 접속
2. 로그인
3. "개인 회의 ID (PMI)" 섹션에서 링크 복사
   예: https://zoom.us/j/1234567890
```

#### 방법 B: Zoom 앱
```
1. Zoom 앱 실행
2. 설정(⚙️) → 프로필
3. "개인 회의 ID (PMI)" 확인
4. 링크 형식: https://zoom.us/j/[당신의 PMI 번호]
```

### 2️⃣ **테스트 실행**

```
1. sat-lec-rec 앱 실행
2. 우측 상단 🐛 버튼 클릭
3. "Zoom 회의 링크"에 PMI 링크 입력
4. 각 버튼을 순서대로 클릭:

   ① Zoom 링크 실행        → Zoom 앱이 열림
   ② 이름 입력 + 참가       → 자동으로 이름 입력 및 참가
   ③ 오디오 참가           → 컴퓨터 오디오 연결
   ④ 비디오 끄기           → 비디오 자동 꺼짐
   ⑤ 음소거               → 마이크 자동 음소거
   ⑥ Zoom 종료            → 테스트 완료
```

### 3️⃣ **결과 확인**

각 단계마다 **"테스트 결과"** 카드에서 성공/실패 확인:
```
✅ 성공 → 다음 단계 진행
❌ 실패 → 로그 확인 후 재시도
```

---

## 🔒 보안 주의사항

### ⚠️ PMI 사용 시 주의

PMI는 **누구나 접속 가능한 공개 회의실**입니다. 테스트 중 다른 사람이 들어올 수 있습니다.

**해결방법:**
1. **대기실 활성화** (권장)
   ```
   Zoom 웹 → 설정 → 회의 중(고급) → 대기실 켜기
   ```

2. **암호 설정**
   ```
   PMI 링크에 ?pwd=암호 추가
   예: https://zoom.us/j/1234567890?pwd=abc123
   ```

3. **테스트는 늦은 시간에**
   ```
   심야(23:00~06:00)에 테스트하면 방해 받을 확률 낮음
   ```

---

## 🧪 단계별 테스트 시나리오

### **시나리오 1: 빠른 기능 확인** (5분)

```
목표: 각 버튼이 작동하는지만 확인

1. Zoom 링크 실행          (5초 대기)
2. 이름 입력 + 참가         (참가 확인)
3. 오디오 참가             (오디오 연결 확인)
4. Zoom 종료               (완료)
```

### **시나리오 2: 전체 플로우 테스트** (10분)

```
목표: 실제 강의와 동일한 순서로 테스트

1. Zoom 링크 실행
2. 이름 입력 + 참가
3. [대기실 있으면] 대기실 확인 (수동으로 승인)
4. 오디오 참가
5. 비디오 끄기
6. 음소거
7. [녹화 시작 테스트]
8. 10분 대기
9. [녹화 중지 테스트]
10. Zoom 종료
```

### **시나리오 3: 에러 처리 테스트** (15분)

```
목표: 예외 상황에서 앱이 올바르게 동작하는지 확인

1. 잘못된 링크로 테스트
   → 예상: "Zoom 실행 실패" 에러

2. Zoom 실행 후 5초 안에 "참가" 클릭
   → 예상: "버튼을 찾을 수 없습니다" 경고

3. 참가 후 오디오 버튼이 나타나기 전에 클릭
   → 예상: 재시도 후 성공

4. 네트워크 끊기 (Wi-Fi 끄기)
   → 예상: "호스트 대기 실패" 에러
```

---

## 🚨 문제 해결

### **Issue 1: "버튼을 찾을 수 없습니다"**

**원인:** Zoom UI가 로드되지 않음

**해결:**
```
1. 5~10초 대기 후 재시도
2. Zoom 창이 최소화되어 있으면 복원
3. Zoom 버전 업데이트 (최신 버전 권장)
```

### **Issue 2: "UI Automation 초기화 실패"**

**원인:** Windows COM 초기화 오류

**해결:**
```
1. 앱 완전 종료 후 재시작
2. Windows 재부팅
3. 관리자 권한으로 앱 실행
```

### **Issue 3: Zoom 창이 안 뜸**

**원인:** Zoom 앱이 설치되지 않았거나 경로가 다름

**해결:**
```powershell
# Zoom 설치 확인
Test-Path "C:\Program Files\Zoom\bin\Zoom.exe"

# 없으면 다운로드
start https://zoom.us/download
```

---

## 📊 테스트 체크리스트

### 기본 기능 ✅
- [ ] Zoom 링크 실행 성공
- [ ] 이름 자동 입력 성공
- [ ] 참가 버튼 자동 클릭 성공
- [ ] 오디오 참가 버튼 클릭 성공
- [ ] 비디오 켜기/끄기 성공
- [ ] 음소거/해제 성공
- [ ] Zoom 종료 성공

### 상태 확인 ✅
- [ ] 대기실 확인 성공
- [ ] 호스트 대기 확인 성공
- [ ] 자동화 상태 UI 업데이트 확인
- [ ] 토스트 알림 표시 확인

### 에러 처리 ✅
- [ ] 잘못된 링크 에러 처리
- [ ] 네트워크 단절 에러 처리
- [ ] UI 버튼 없을 때 재시도
- [ ] 타임아웃 처리

---

## 🎯 다음 단계

테스트가 모두 통과하면:

1. **설정 화면에 PMI 저장**
   - "테스트용 Zoom 링크" 입력 필드 추가
   - 테스트 버튼 한 번에 실행

2. **실제 예약 강의에 적용**
   - 스케줄 서비스에 자동화 통합
   - 녹화 시작 전 자동 참가 실행

3. **안정성 개선**
   - 재시도 횟수 증가
   - 더 많은 에러 케이스 처리

---

## 💡 고급 팁

### **팁 1: Zoom 버전 고정**
```
Zoom은 업데이트될 때마다 UI가 바뀔 수 있습니다.
자동 업데이트를 끄고 안정적인 버전을 사용하세요.

Zoom 설정 → 일반 → "Zoom을 최신 버전으로 유지" 끄기
```

### **팁 2: 로그 활용**
```
앱의 로그 파일에서 상세한 정보 확인:
- 어떤 버튼을 찾았는지
- 몇 초가 걸렸는지
- 어떤 에러가 발생했는지
```

### **팁 3: 스크린샷 저장**
```dart
// 향후 추가 예정
// 각 단계마다 스크린샷 자동 저장
```

---

## 📞 도움이 필요하면

1. **로그 파일 확인**
   ```
   앱 실행 디렉토리의 logs/ 폴더
   ```

2. **GitHub Issue 등록**
   ```
   https://github.com/Eyebottle/sat-lec-rec/issues
   ```

3. **테스트 결과 공유**
   ```
   체크리스트 스크린샷 첨부
   ```
